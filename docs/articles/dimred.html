<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Use FactoMineR for dimension reduction â€¢ sfutils</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Use FactoMineR for dimension reduction">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sfutils</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../TODO.html">To do</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    See also
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://github.com/cortical-io/retina-sdk.py">Python retinasdk module</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Useful links
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="http://api.cortical.io">Cortical API tool</a>
    </li>
    <li>
      <a href="http://documentation.cortical.io/the_power_of_expressions.html">Retina API documentation</a>
    </li>
    <li>
      <a href="http://www.cortical.io/static/downloads/semantic-folding-theory-white-paper.pdf">Semantic folding whitepaper</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://www.cortical.io">Cortical.io</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../mailto:jasperginn@gmail.com">
    <span class="fa fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/JasperHG90/sfutils">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Use FactoMineR for dimension reduction</h1>
                        <h4 class="author">Jasper Ginn</h4>
            
            <h4 class="date">2018-05-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JasperHG90/sfutils.git/blob/master/vignettes/dimred.Rmd"><code>vignettes/dimred.Rmd</code></a></small>
      <div class="hidden name"><code>dimred.Rmd</code></div>

    </div>

    
    
<p>Because the retina returns binary values in a finite space (16384 positions), doing computations is more efficient than many other methods. However, the more documents you have, the more expensive computation becomes, especially if you want to compare documents to one another.</p>
<p>Fortunately, we can reduce the number of dimensions of the retina dramatically while retaining sensible results. This vignette shows how this can be done.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(sfutils))
<span class="co">#&gt; No cortical key registered. Execute 'Sys.setenv('CORTICAL_API_KEY' = '&lt;your-key&gt;')' to set your credentials.</span>
<span class="co"># Load data</span>
<span class="kw">data</span>(<span class="st">"SAP500"</span>)</code></pre></div>
<p>We will make a subset of this data (50 companies) for the purposes of this document:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Choose these companies</span>
chosen &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">12</span><span class="op">:</span><span class="dv">13</span>,
            <span class="dv">16</span>, <span class="dv">21</span>, <span class="dv">28</span><span class="op">:</span><span class="dv">29</span>, 
            <span class="dv">33</span>, <span class="dv">35</span>, <span class="dv">60</span><span class="op">:</span><span class="dv">62</span>, 
            <span class="dv">69</span>, <span class="dv">80</span>, <span class="dv">119</span>, <span class="dv">121</span>,
            <span class="dv">149</span>, <span class="dv">160</span>, <span class="dv">168</span>, <span class="dv">174</span>,
            <span class="dv">183</span>, <span class="dv">186</span>, <span class="dv">193</span>, <span class="dv">205</span>,
            <span class="dv">219</span>, <span class="dv">229</span>, <span class="dv">235</span>, <span class="dv">262</span>,
            <span class="dv">266</span>, <span class="dv">278</span>, <span class="dv">279</span>, <span class="dv">338</span>,
            <span class="dv">339</span>, <span class="dv">342</span>, <span class="dv">343</span>, <span class="dv">353</span>, 
            <span class="dv">355</span>, <span class="dv">359</span>, <span class="dv">362</span>, <span class="dv">373</span>,
            <span class="dv">378</span>, <span class="dv">387</span>, <span class="dv">409</span>, <span class="dv">435</span>, 
            <span class="dv">436</span>, <span class="dv">453</span>, <span class="dv">468</span>, <span class="dv">487</span>) <span class="co"># 366</span>
<span class="co"># Subset</span>
subs &lt;-<span class="st"> </span>SAP500[chosen]
<span class="kw">names</span>(subs)
<span class="co">#&gt;  [1] "Booking Holdings Inc"          "Amazon.com Inc"               </span>
<span class="co">#&gt;  [3] "Alphabet Inc"                  "Boeing Co"                    </span>
<span class="co">#&gt;  [5] "Netflix Inc"                   "Lockheed Martin Corp"         </span>
<span class="co">#&gt;  [7] "Humana Inc"                    "FedEx Corp"                   </span>
<span class="co">#&gt;  [9] "NVIDIA Corp"                   "Goldman Sachs Group Inc"      </span>
<span class="co">#&gt; [11] "Broadcom Inc"                  "Mastercard Inc"               </span>
<span class="co">#&gt; [13] "Apple Inc"                     "Facebook Inc"                 </span>
<span class="co">#&gt; [15] "Aetna Inc"                     "Red Hat Inc"                  </span>
<span class="co">#&gt; [17] "Electronic Arts Inc"           "Visa Inc"                     </span>
<span class="co">#&gt; [19] "Universal Health Services Inc" "JPMorgan Chase &amp; Co"          </span>
<span class="co">#&gt; [21] "Citrix Systems Inc"            "HCA Healthcare Inc"           </span>
<span class="co">#&gt; [23] "American Express Co"           "Raymond James Financial Inc"  </span>
<span class="co">#&gt; [25] "Microsoft Corp"                "Time Warner Inc"              </span>
<span class="co">#&gt; [27] "Western Digital Corp"          "Walmart Inc"                  </span>
<span class="co">#&gt; [29] "PayPal Holdings Inc"           "Nike Inc"                     </span>
<span class="co">#&gt; [31] "Activision Blizzard Inc"       "Best Buy Co Inc"              </span>
<span class="co">#&gt; [33] "Citigroup Inc"                 "Delta Air Lines Inc"          </span>
<span class="co">#&gt; [35] "Foot Locker Inc"               "Intel Corp"                   </span>
<span class="co">#&gt; [37] "Wells Fargo &amp; Co"              "Morgan Stanley"               </span>
<span class="co">#&gt; [39] "Southwest Airlines Co"         "Cardinal Health Inc"          </span>
<span class="co">#&gt; [41] "CBS Corp"                      "Verizon Communications Inc"   </span>
<span class="co">#&gt; [43] "Oracle Corp"                   "Cisco Systems Inc"            </span>
<span class="co">#&gt; [45] "Twenty-First Century Fox Inc"  "AT&amp;T Inc"                     </span>
<span class="co">#&gt; [47] "Comcast Corp"                  "Viacom Inc"                   </span>
<span class="co">#&gt; [49] "HP Inc"                        "Hewlett Packard Enterprise Co"</span></code></pre></div>
<p>We fingerprint the descriptions, calculate a distance matrix and cluster the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Retrieve only descriptions</span>
desc_only &lt;-<span class="st"> </span><span class="kw">lapply</span>(subs, <span class="cf">function</span>(x) x<span class="op">$</span>desc)

<span class="co"># Fingerprint</span>
fps &lt;-<span class="st"> </span><span class="kw"><a href="../reference/do_fingerprint_document.html">do_fingerprint_document</a></span>(desc_only)

<span class="co"># To matrix</span>
binmat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(fps)
<span class="kw">rownames</span>(binmat) &lt;-<span class="st"> </span><span class="kw">names</span>(desc_only)

<span class="co"># Distances (need to convert matrix from Matrix package to normal matrix)</span>
fpsdst &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">as.matrix</span>(binmat))

<span class="co"># Do hierarchical clustering and plot</span>
clust &lt;-<span class="st"> </span><span class="kw">hclust</span>(fpsdst, <span class="dt">method =</span> <span class="st">"ward.D2"</span>)</code></pre></div>
<p><img src="dendro1.png" width="80%/"></p>
<p>We now do the same but using PCA to reduce the number of columns to 30</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reduce dimensions</span>
<span class="kw">library</span>(FactoMineR)
red &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/FactoMineR/topics/PCA">PCA</a></span>(<span class="kw">as.matrix</span>(binmat),
           <span class="dt">ncp =</span> <span class="kw">ncol</span>(binmat), <span class="dt">graph =</span> <span class="ot">FALSE</span>)

<span class="co"># Predict</span>
pred &lt;-<span class="st"> </span><span class="kw">predict</span>(red, binmat)<span class="op">$</span>coord

<span class="co"># Take 64 dims</span>
pred_filt &lt;-<span class="st"> </span>pred[,<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># As distance</span>
dd &lt;-<span class="st"> </span><span class="kw">dist</span>(pred_filt)

<span class="co"># Cluster</span>
clusts &lt;-<span class="st"> </span><span class="kw">hclust</span>(dd, <span class="dt">method =</span> <span class="st">"ward.D2"</span>)</code></pre></div>
<p><img src="dendro2.png" width="80%/"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jasper Ginn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
